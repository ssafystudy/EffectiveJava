# 21. μΈν„°νμ΄μ¤λ” κµ¬ν„ν•λ” μ½μ„ μƒκ°ν•΄ μ„¤κ³„ν•λΌ

> π’΅ λ””ν΄νΈ λ©”μ„λ“ μ‚¬μ©ν•λ” κ²ƒμ„ μ§€μ–‘ν•κ³ , μΈν„°νμ΄μ¤λ¥Ό μ„¤κ³„ν•  λ•λ¶€ν„° μ£Όμλ¥Ό κΈ°μΈμ΄μ.

Java 8 μ΄μ „ μΈν„°νμ΄μ¤λ” λ©”μ„λ“ μ„ μ–Έλ§ κ°€λ¥ν•  λΏ, μ‹¤μ  λ©”μ„λ“ κµ¬ν„μ€ ν•΄λ‹Ή μΈν„°νμ΄μ¤λ¥Ό `implements`ν• ν•μ„ ν΄λμ¤μ—μ„ μ΄λ¤„μ΅λ‹¤. κ·Έλμ„ μΈν„°νμ΄μ¤μ— λ©”μ„λ“λ¥Ό μ¶”κ°€ν•  λ°©λ²•μ΄ μ—†μ—λ‹¤. μƒλ΅μ΄ λ©”μ„λ“λ¥Ό μ¶”κ°€ν•λ©΄, κΈ°μ΅΄ κµ¬ν„μ²΄μ—μ„ μ»΄νμΌ μ—λ¬κ°€ λ‚  ν™•λ¥ μ΄ μ•„μ£Ό λ†’μ•κΈ° λ•λ¬Έμ΄λ‹¤.

<br/>
Java 8λ¶€ν„°λ” λ””ν΄νΈ λ©”μ„λ“κ°€ λ“±μ¥ν•λ‹¤.

λ””ν΄νΈ λ©”μ„λ“λ¥Ό μ‚¬μ©ν•λ©΄, κΈ°μ΅΄ μΈν„°νμ΄μ¤μ— λ©”μ„λ“(μ„ μ–Έ + κµ¬ν„)λ¥Ό μ¶”κ°€ν•  μ μλ‹¤. κµ¬ν„μ²΄μ—μ„λ” λ””ν΄νΈ λ©”μ„λ“λ¥Ό μ¬μ •μν•  μλ„ μκ³ , λ§μ•½ μ¬μ •μν•μ§€ μ•λ”λ‹¤λ©΄ μΈν„°νμ΄μ¤μ κµ¬ν„μ΄ κ·Έλ€λ΅ μ“°κ² λλ‹¤.

ν•μ§€λ§ λ¬Έμ κ°€ μλ‹¤. λ¨λ“  μƒν™©μ—μ„ λ¶λ³€μ‹(Invariant, ν΄λμ¤μ μλ… λ™μ• ν•­μƒ trueμ—¬μ•Ό ν•λ” μ΅°κ±΄ λ“±)μ„ ν•΄μΉμ§€ μ•λ” λ””ν΄νΈ λ©”μ„λ“λ¥Ό μ‘μ„±ν•κΈ΄ λ§¤μ° μ–΄λ µλ‹¤. μμ‹λ΅ μ•μ•„λ³΄μ.

<br/>

Java 8λ¶€ν„° μ»¬λ ‰μ… μΈν„°νμ΄μ¤λ“¤μ— λλ‹¤λ¥Ό ν™μ©ν•κΈ° μ„ν•΄μ„ λ‹¤μμ λ””ν΄νΈ λ©”μ„λ“κ°€ μ¶”κ°€λμ—λ‹¤.

Java 8μ `Collection` μΈν„°νμ΄μ¤μ— μ¶”κ°€λ `removeIf` λ©”μ„λ“λ¥Ό λ³΄μ.

```java
// μ£Όμ–΄μ§„ Predicate(λ¶λ¦¬μ–Έ ν•¨μ)μ΄ trueλ¥Ό λ°ν™ν•λ©΄, λ¨λ“  μ›μ†λ¥Ό μ κ±°ν•λ” λ©”μ„λ“
default boolean removeIf(Predicate<? super E> filter) {
	Objects.requireNonNull(filter);
	boolean result = false;
	for (Iterator<E> it = iterator(); it.hasNext();) {
		if (filter.test(it.next())) { // κ° μ›μ†μ— λ€ν•΄ Predicate νΈμ¶
			it.remove(); // Predicateμ΄ trueλ©΄ μ‚­μ 
			result = true;
		}
	}
	return result;
}
```

μ„ λ””ν΄νΈ λ©”μ„λ“λ” `org.apache.commons.collections4.collection.SynchronizedCollection`
μ™€μ νΈν™μ„± λ¬Έμ κ°€ μμ—λ‹¤.

μ΄ ν΄λμ¤λ” `Collection` μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•λ” ν΄λμ¤λ΅, `Collection`μ λ¨λ“  λ©”μ„λ“λ¥Ό `synchronized` λΈ”λ΅μ„ μ‚¬μ©ν•΄ μ¬μ •μν•λ” λνΌ ν΄λμ¤μ΄λ‹¤. λ¨λ“  λ©”μ„λ“μ—μ„ μ£Όμ–΄μ§„ λ½ κ°μ²΄λ΅ λ™κΈ°ν™”ν•λ©΄μ„ thread-safeν•¨μ„ λ³΄μ¥ν•λ‹¤.

```java
@Override
public int size() {
	synchronized (lock) {
		return decorated().size();
	}
}
```

ν•μ§€λ§ `Collection`μ— `removeIf`λ¥Ό λ””ν΄νΈ λ©”μ„λ“λ΅ μ¶”κ°€ν•λ©΄μ„, μ΄ ν΄λμ¤μ λ¶λ³€μ‹μ΄ κΉ¨μ§€κ² λλ‹¤.

`SynchronizedCollection`μ—μ„ `removeIf`λ¥Ό μ¬μ •μν•μ§€ μ•μ•κΈ° λ•λ¬Έμ— λ™κΈ°ν™”λ¥Ό μ κ³µν•μ§€ μ•λ” `Collection`μ `removeIf`κ°€ λ¶λ¦¬λ” κ²ƒμ΄λ‹¤.

`SynchronizedCollection` μΈμ¤ν„΄μ¤λ¥Ό κ³µμ ν•λ” λ©€ν‹° μ¤λ λ“ ν™κ²½μ—μ„ ν• μ¤λ λ“κ°€ `removeIf`λ¥Ό νΈμ¶ν•λ©΄, λ™κΈ°ν™” κ΄€λ ¨ μ—λ¬κ°€ λ°μƒν•  μ μλ‹¤.

(μ§€κΈμ€ 4.4 λ²„μ „μ—μ„ `removeIf`κ°€ μ¬μ •μλμ–΄ λ¬Έμ κ°€ λ°μƒν•μ§€ μ•λ”λ‹¤.)

μ΄μ™€ κ°™μ΄ λ””ν΄νΈ λ©”μ„λ“λ” μ»΄νμΌ λ¬Έμ κ°€ λ°μƒν•μ§€ μ•λ”λΌλ„, κΈ°μ΅΄ κµ¬ν„μ²΄μ— λ°νƒ€μ„ μ¤λ¥λ¥Ό μΌμΌν‚¬ μ μλ‹¤.

<br/>

λ””ν΄νΈ λ©”μ„λ“λ” μƒλ΅μ΄ μΈν„°νμ΄μ¤λ¥Ό λ§λ“¤ λ•μ— ν‘μ¤€μ μΈ λ©”μ„λ“ κµ¬ν„μ„ μ κ³µν•κ³ , λ” μ‰½κ² κµ¬ν„ν•΄ ν™μ©ν•  μ μκ² λ§λ“¤μ–΄μ¤€λ‹¤λ” μ¥μ μ΄ μλ‹¤.

ν•μ§€λ§ κΈ°μ΅΄μ μΈν„°νμ΄μ¤μ— λ””ν΄νΈ λ©”μ„λ“λ΅ μƒ λ©”μ„λ“λ¥Ό μ¶”κ°€ν•λ” κ²ƒμ€ κΈ°μ΅΄ ν΄λΌμ΄μ–ΈνΈλ¥Ό λ§κ°€λ¨λ¦΄ μλ„ μλ” μ„ν—ν• μΌμ΄λ‹¤. μ λ€ λ©”μ„λ“λ¥Ό μ κ±°ν•κ±°λ‚ μμ •ν•λ” μ©λ„λ΅ μ‚¬μ©ν•μ§€ λ§μ.

<br/>

κ²°λ΅ μ μΌλ΅, μΈν„°νμ΄μ¤λ¥Ό μ„¤κ³„ν•  λ•λ” μ—¬μ „ν μ„Έμ‹¬ν• μ£Όμλ¥Ό κΈ°μΈμ—¬μ•Ό ν•λ‹¤.

λ‚μ¤‘μ— λ””ν΄νΈ λ©”μ„λ“λ΅ κ³ μ³μ•Όμ§€, μ΄λ ‡κ² μƒκ°ν•λ©΄ μ• λλ‹¤.

μƒλ΅μ΄ μΈν„°νμ΄μ¤λ¥Ό λ§λ“¤ λ•, μµμ† μ„Έ κ°€μ§€μ κµ¬ν„μ²΄λ¥Ό λ§λ“¤κ³ , ν΄λΌμ΄μ–ΈνΈλ„ λ§λ“¤μ–΄λ³΄λ©΄μ„ μ—΄μ‹¬ν ν…μ¤νΈν•μ. μΈν„°νμ΄μ¤λ¥Ό λ¦΄λ¦¬μ¤ν• ν›„μ—λ” μμ •ν•μ§€ λ»ν•  κ²ƒμ΄λΌκ³  μƒκ°ν•κ³ , λ―Έλ¦¬λ―Έλ¦¬ κ²°ν•¨μ„ μ°Ύλ” κ²ƒμ΄ μΆ‹λ‹¤.
